// Mobile Layout - Complete Rework
@use '../variables' as *;

// Mobile breakpoint
@media (max-width: 991px) {
  // Reset body and html for mobile
  body {
    overflow-x: hidden;
  }

  // Header - Full width on mobile, no offset
  header.header {
    position: fixed !important;
    top: 0 !important;
    left: 0 !important; // Start from left edge
    right: 0 !important;
    width: 100% !important;
    height: 60px !important;
    z-index: 100 !important; // Below sidebar
    background: white !important;
    box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
    padding: 0 15px !important;
    display: flex !important;
    align-items: center !important;
  }

  // Sidebar - Overlay style on mobile
  .left-panel {
    position: fixed !important;
    top: 60px !important; // Start below header
    left: 0 !important;
    bottom: 0 !important;
    width: 280px !important;
    max-width: 85vw !important; // Never wider than 85% of viewport
    height: calc(100vh - 60px) !important; // Full height minus header
    background: #2c3e50 !important;
    z-index: 500 !important; // Below header but above content
    transform: translateX(-100%) !important;
    transition: transform 0.3s ease-in-out !important;
    overflow-y: auto !important;
    overflow-x: hidden !important;
    
    // When open
    &.mobile-open {
      transform: translateX(0) !important;
      box-shadow: 5px 0 25px rgba(0,0,0,0.5) !important;
    }

    // Ignore collapsed state completely on mobile
    &.collapsed {
      width: 280px !important;
      transform: translateX(-100%) !important;
      
      &.mobile-open {
        transform: translateX(0) !important;
      }
      
      // Override ALL collapsed styles
      .sidebar-menu {
        padding: 20px 0 20px 0 !important; // Less top padding since parent has padding-top
      }
      
      .nav-section {
        display: block !important;
        padding: 0 20px !important;
        margin: 20px 0 10px !important;
        
        .nav-section-title {
          display: block !important;
          font-size: 11px !important;
          text-align: left !important;
        }
      }
      
      .nav-item {
        margin: 2px 0 !important;
        
        .nav-link {
          padding: 10px 20px !important;
          justify-content: flex-start !important;
          font-size: 14px !important;
          
          .nav-icon {
            width: 20px !important;
            margin-right: 12px !important;
            font-size: 16px !important;
          }
          
          .nav-text {
            display: inline-block !important;
            opacity: 1 !important;
            visibility: visible !important;
          }
          
          .nav-arrow {
            display: inline-block !important;
            opacity: 1 !important;
            visibility: visible !important;
          }
          
          &.active::before {
            display: block !important;
            width: 3px !important;
          }
        }
        
        .nav-submenu {
          display: none;
          
          &.show {
            display: block !important;
          }
        }
      }
    }
  }

  // Main content - Full width on mobile
  .main-content,
  .right-panel {
    margin-left: 0 !important;
    padding-top: 60px !important; // Height of mobile header
    width: 100% !important;
    position: relative !important;
  }

  // Content area adjustment
  .content {
    padding: 15px !important;
  }

  // Overlay when sidebar is open
  .sidebar-overlay {
    position: fixed !important;
    top: 60px !important; // Start below header
    left: 0 !important;
    right: 0 !important;
    bottom: 0 !important;
    background: rgba(0, 0, 0, 0.7) !important;
    z-index: 499 !important; // Just below sidebar
    display: none !important;
    
    &.show {
      display: block !important;
    }
  }

  // Header components on mobile
  .header {
    .header-toggle {
      padding: 8px !important;
      margin-right: 10px !important;
      font-size: 22px !important;
    }

    .header-search {
      display: none !important; // Hide search on mobile
    }

    .header-menu {
      margin-left: auto !important;
      gap: 5px !important;
    }

    .header-notifications,
    .header-messages {
      .btn {
        padding: 8px !important;
        font-size: 18px !important;
      }
    }

    .header-user {
      .user-info {
        display: none !important; // Hide user info text on mobile
      }
      
      .user-avatar {
        width: 30px !important;
        height: 30px !important;
      }
    }
  }
}

// Ensure no horizontal scroll on mobile
@media (max-width: 991px) {
  html {
    overflow-x: hidden !important;
  }
  
  body {
    overflow-x: hidden !important;
    position: relative !important;
  }
}